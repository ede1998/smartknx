{% load static %}
{% load smartknx_extra %}
{% with group_tag=device.read_position.group_address|group_address_to_tag %}
<div class="card bg-dark text-white" id="{{ group_tag }}">
    <div class="card-body d-flex flex-column justify-content-center">
      <img class="mb-3" src="{% static 'smartknx/windowblind_middle.svg' %}" alt="Card image" style="max-height:25vh">
      <input class="move-position" type="text" style="width:100%" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="30" />
      <div class="btn-group btn-group-lg btn-block mt-3">
        <button type="button" class="btn btn-dark text-white move-up">▲</button>
        <button type="button" class="btn btn-dark text-white move-stop">■</button>
        <button type="button" class="btn btn-dark text-white move-down">▼</button>
      </div>
    </div>
    <div class="card-footer text-center">
      <h4 class="card-text">{{ device.name }}</h4>
    </div>
    <script type="text/javascript">
    {
        let slider = create_slider("#{{group_tag}} .move-position");
        let div_element = document.querySelector("#{{group_tag}}");



        div_element.update = function (data) {
            let img = document.querySelector("#" + tag_name + " div img")
            img.src = ""; //data === true?"{% static 'smartknx/light_on.svg' %}" :"{% static 'smartknx/light_off.svg' %}";
            change_rangeHighlights(slider, 14);
        }

        slider.on("slide", function(sliderValue) {
            document.querySelector("#{{group_tag}} .move-position").textContent = sliderValue;
        });

        div_element.querySelector(".move-up").onclick = function () {
            msg = { type: "B1", group_address:"{{device.write_direction.group_address}}", data: true};
            knxSocket.send(JSON.stringify(msg));
        }

        div_element.querySelector(".move-stop").onclick = function () {
            msg = { type: "B1", group_address:"{{device.write_stop.group_address}}", data: true};
            knxSocket.send(JSON.stringify(msg));
        }

        div_element.querySelector(".move-down").onclick = function () {
            msg = { type: "B1", group_address:"{{device.write_direction.group_address}}", data: false};
            knxSocket.send(JSON.stringify(msg));
        }
    }
    </script>
</div>
{% endwith %}